%!PS-Adobe-3.0 EPSF-3.0
%%Creator: Brad Nelson
%%Title: Haiku Forth Dice
%%DocumentData: Clean7Bit
%%Origin: 0 0
%%BoundingBox: 0 0 612 792
%%LanguageLevel: 2
%%Pages: 1
%%Page: 1 1

/mm {
  720 mul 224 div
} def

/side {
  44 mm
} def

/halfside {
  side 2 div
} def

/face {
  gsave
  halfside -1 mul dup translate
  newpath
  0 0 moveto
  side 0 lineto
  side side lineto
  0 side lineto
  0 0 lineto
  0.1 setlinewidth
  stroke
  grestore
  exec
} def

/textface {
  /Helvetica-Bold findfont   24 scalefont   setfont
  newpath
  0 -3 moveto
  dup stringwidth pop 2 div neg 0 rmoveto show
} def

/onebit {
  dup 2 div truncate 2 mul sub
} def

/dropbit {
  2 div truncate
} def

/box {
  save
  5 1 roll
  4 2 roll
  translate
  scale
  newpath
  0 0 moveto
  0 1 rlineto
  1 0 rlineto
  0 -1 rlineto
  closepath
  fill
  restore
} def

/bardot {
  1.7 mul mm 0 mm 1.7 mm 3 mm box
} def

/barcode {
  save 
  exch
  1 0 1 setrgbcolor
  -2 bardot
  1 bardot
  0 0 0 setrgbcolor
  -1 bardot
  1 1 1 setrgbcolor
  0 bardot
  dup
  /num 2 def
  8 {
    dup onebit dup dup setrgbcolor
    dropbit
    num bardot
    /num num 1 add def
  } repeat
  pop
  /num -3 def
  8 {
    dup onebit 1 exch sub dup dup setrgbcolor
    dropbit
    num bardot
    /num num 1 sub def
  } repeat
  pop
  restore 
} def

/tile {
  textface
  face
  save
  exch
  0 halfside 3 div 2 mul translate
  barcode
  restore
} def

/labels [
  (x)
  (y)
  (t)
  (push)
  (pop)
  (dup)
  (over)
  (2dup)
  (drop)
  (swap)
  (=)
  (<>)
  (<)
  (>)
  (<=)
  (>=)
  (and)
  (or)
  (not)
  (min)
  (max)
  (+)
  (-)
  (*)
  (/)
  (mod)
  (pow)
  (atan2)
  (negate)
  (sin)
  (cos)
  (tan)
  (log)
  (exp)
  (sqrt)
  (floor)
  (ceil)
  (abs)
  (pi)
  (z+)
  (z-)
  (z*)
  (random)
  (:)
  (;)
  (A)
  (B)
  (C)
  (D)
  (0)
  (0.1)
  (0.2)
  (0.3)
  (0.4)
  (0.5)
  (0.6)
  (0.7)
  (0.8)
  (0.9)
  (1)
  (2)
  (3)
  (4)
  (5)
  (6)
  (7)
  (8)
  (9)
  (10)
  (11)
  (12)
  (13)
  (14)
  (15)
  (16)
  (17)
  (18)
  (19)
  (20)
  (21)
  (22)
  (23)
  (24)
  (25)
  (junk)
  (junk)
  (junk)
  (junk)
  (junk)
  (junk)
  (junk)
  (junk)
  (junk)
  (junk)
  (junk)
  (junk)
  (junk)
  (junk)
  (junk)
  (junk)
  (junk)
  (junk)
  (junk)
  (junk)
  (junk)
  (junk)
  (junk)
  (junk)
  (junk)
  (junk)
  (junk)
] def

/code 0 def
3 {
  0.66 0.66 scale
  40 mm 30 mm translate
  7 { 
    gsave
    5 {
      code labels code get tile
      50 mm 0 mm translate 
      /code code 1 add def
    } repeat
    grestore
    0 mm 50 mm translate 
  } repeat
  showpage
} repeat

%%EOF
